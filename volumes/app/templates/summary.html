{% extends "base.html" %}



{% block title %}Zusammenfassung - {{ current_user.username }}{% endblock %}



{% block extra_css %}

<style>

    /* Summary-specific styles */

    .date-filter {

        background: white;

        border: 1px solid #e1e5e9;

        padding: 20px;

        margin-bottom: 30px;

    }

    

    .date-filter h2 {

        font-size: 16px;

        font-weight: 500;

        margin-bottom: 15px;

        color: #444;

    }

    

    .date-inputs {

        display: flex;

        gap: 15px;

        align-items: center;

        flex-wrap: wrap;

    }

    

    .date-inputs label {

        font-weight: 500;

        color: #333;

    }

    

    .summary-section {

        background: white;

        border: 1px solid #e1e5e9;

    }

    

    .summary-header {

        background: #f6f8fa;

        padding: 16px;

        border-bottom: 1px solid #e1e5e9;

        display: flex;

        justify-content: space-between;

        align-items: center;

    }

    

    .summary-header h2 {

        font-size: 18px;

        font-weight: 500;

        color: #333;

    }

    

    .total-time {

        font-size: 16px;

        font-weight: 600;

        color: #0969da;

    }

    

    .summary-table {

        width: 100%;

        border-collapse: collapse;

    }

    

    .summary-table th {

        background: white;

        padding: 12px 16px;

        text-align: left;

        font-weight: 500;

        color: #333;

        border-bottom: 1px solid #e1e5e9;

    }

    

    .summary-table td {

        padding: 12px 16px;

        border-bottom: 1px solid #f1f3f4;

        vertical-align: middle;

    }

    

    .summary-table tr:hover {

        background: #f6f8fa;

    }

    

    .ticket-name {

        font-weight: 500;

        color: #333;

    }

    

    .hours {

        text-align: right;

        font-weight: 500;

        color: #0969da;

    }

    

    .percentage {

        text-align: right;

        color: #656d76;

        font-size: 13px;

    }

    

    .no-data {

        text-align: center;

        color: #656d76;

        padding: 40px 20px;

        background: white;

    }

    

    .date-range-display {

        color: #656d76;

        font-size: 16px;

        margin-bottom: 5px;

    }

    

    @media (max-width: 768px) {

        .date-inputs {

            flex-direction: column;

            align-items: flex-start;

        }

        

        .summary-header {

            flex-direction: column;

            align-items: flex-start;

            gap: 10px;

        }

    }

</style>

{% endblock %}



{% block page_title %}Zusammenfassung{% endblock %}



{% block nav_links %}

<a href="{{ url_for('index') }}" class="nav-link">Zur체ck zur Zeiterfassung</a>

{% endblock %}



{% block content %}

<!-- Date Filter -->

<div class="date-filter">

    <h2>Zeitraum ausw채hlen</h2>

    <form method="get" action="{{ url_for('summary') }}">

        <div class="date-inputs">

            <label for="start_date">Von:</label>

            <input type="date" id="start_date" name="start_date" value="{{ start_date }}" required>

            

            <label for="end_date">Bis:</label>

            <input type="date" id="end_date" name="end_date" value="{{ end_date }}" required>

            

            <button type="submit" class="btn btn-primary">Aktualisieren</button>

        </div>

    </form>

</div>



<!-- Summary Results -->

<div class="summary-section">

    <div class="summary-header">

        <div>

            <div class="date-range-display">

                {% if start_date == end_date %}

                    {{ start_date }}

                {% else %}

                    {{ start_date }} bis {{ end_date }}

                {% endif %}

            </div>

            <h2>Zeiterfassung nach Tickets</h2>

        </div>

        <div class="total-time">

            Gesamt: {{ "%.2f"|format(total_time) }}h

        </div>

    </div>

    

    {% if summary_data %}

        <table class="summary-table">

            <thead>

                <tr>

                    <th>Ticket</th>

                    <th style="text-align: right;">Stunden</th>

                    <th style="text-align: right;">Anteil</th>

                </tr>

            </thead>

            <tbody>

                {% for ticket_name, hours in summary_data.items() %}

                <tr>

                    <td class="ticket-name">{{ ticket_name }}</td>

                    <td class="hours">{{ "%.2f"|format(hours) }}h</td>

                    <td class="percentage">

                        {% if total_time > 0 %}

                            {{ "%.1f"|format((hours / total_time) * 100) }}%

                        {% else %}

                            0%

                        {% endif %}

                    </td>

                </tr>

                {% endfor %}

            </tbody>

        </table>

    {% else %}

        <div class="no-data">

            Keine Daten f체r den ausgew채hlten Zeitraum gefunden.

        </div>

    {% endif %}

</div>

{% endblock %}
