<!DOCTYPE html>

<html lang="de">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Zusammenfassung - {{ current_user.username }}</title>

    <style>

        * {

            margin: 0;

            padding: 0;

            box-sizing: border-box;

        }

        

        body {

            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;

            background: #fafafa;

            color: #333;

            line-height: 1.5;

            font-size: 14px;

        }

        

        .container {

            max-width: 800px;

            margin: 0 auto;

            padding: 20px;

        }

        

        .header {

            display: flex;

            justify-content: space-between;

            align-items: center;

            margin-bottom: 30px;

        }

        

        .nav-links {

            display: flex;

            gap: 15px;

            align-items: center;

        }

        

        .nav-link {

            color: #0969da;

            text-decoration: none;

            font-size: 14px;

            padding: 8px 12px;

            border: 1px solid #0969da;

            background: white;

            border-radius: 4px;

        }

        

        .nav-link:hover {

            background: #f6f8fa;

        }

        

        h1 {

            font-size: 24px;

            font-weight: 400;

            color: #222;

        }

        

        .user-info {

            display: flex;

            align-items: center;

            gap: 10px;

            background: white;

            padding: 8px 12px;

            border: 1px solid #e1e5e9;

        }

        

        .user-switch {

            color: #0969da;

            text-decoration: none;

            font-size: 12px;

        }

        

        .user-switch:hover {

            text-decoration: underline;

        }

        

        .date-filter {

            background: white;

            border: 1px solid #e1e5e9;

            padding: 20px;

            margin-bottom: 30px;

        }

        

        .date-filter h2 {

            font-size: 16px;

            font-weight: 500;

            margin-bottom: 15px;

            color: #444;

        }

        

        .date-inputs {

            display: flex;

            gap: 15px;

            align-items: center;

            flex-wrap: wrap;

        }

        

        .date-inputs label {

            font-weight: 500;

            color: #333;

        }

        

        .date-inputs input[type="date"] {

            padding: 8px 12px;

            border: 1px solid #d0d7de;

            background: white;

            font-size: 14px;

            outline: none;

        }

        

        .date-inputs input[type="date"]:focus {

            border-color: #0969da;

        }

        

        .btn {

            padding: 8px 16px;

            border: 1px solid #d0d7de;

            background: #0969da;

            color: white;

            cursor: pointer;

            font-size: 14px;

            text-decoration: none;

            display: inline-block;

            border-color: #0969da;

        }

        

        .btn:hover {

            background: #0860ca;

        }

        

        .summary-section {

            background: white;

            border: 1px solid #e1e5e9;

        }

        

        .summary-header {

            background: #f6f8fa;

            padding: 16px;

            border-bottom: 1px solid #e1e5e9;

            display: flex;

            justify-content: space-between;

            align-items: center;

        }

        

        .summary-header h2 {

            font-size: 18px;

            font-weight: 500;

            color: #333;

        }

        

        .total-time {

            font-size: 16px;

            font-weight: 600;

            color: #0969da;

        }

        

        .summary-table {

            width: 100%;

            border-collapse: collapse;

        }

        

        .summary-table th {

            background: white;

            padding: 12px 16px;

            text-align: left;

            font-weight: 500;

            color: #333;

            border-bottom: 1px solid #e1e5e9;

        }

        

        .summary-table td {

            padding: 12px 16px;

            border-bottom: 1px solid #f1f3f4;

            vertical-align: middle;

        }

        

        .summary-table tr:hover {

            background: #f6f8fa;

        }

        

        .ticket-name {

            font-weight: 500;

            color: #333;

        }

        

        .hours {

            text-align: right;

            font-weight: 500;

            color: #0969da;

        }

        

        .percentage {

            text-align: right;

            color: #656d76;

            font-size: 13px;

        }

        

        .no-data {

            text-align: center;

            color: #656d76;

            padding: 40px 20px;

            background: white;

        }

        

        .date-range-display {

            color: #656d76;

            font-size: 16px;

            margin-bottom: 5px;

        }

        

        @media (max-width: 768px) {

            .container {

                padding: 15px;

            }

            

            .header {

                flex-direction: column;

                align-items: flex-start;

                gap: 10px;

            }

            

            .date-inputs {

                flex-direction: column;

                align-items: flex-start;

            }

            

            .summary-header {

                flex-direction: column;

                align-items: flex-start;

                gap: 10px;

            }

        }

    </style>

</head>

<body>

    <div class="container">

        <div class="header">

            <h1>Zusammenfassung</h1>

            <div class="nav-links">

                <a href="{{ url_for('index') }}" class="nav-link">Zur√ºck zur Zeiterfassung</a>

            </div>

            <div class="user-info">

                <span>üë§ {{ current_user.username }}</span>

                <a href="{{ url_for('select_user') }}" class="user-switch">Wechseln</a>

            </div>

        </div>

        

        <!-- Date Filter -->

        <div class="date-filter">

            <h2>Zeitraum ausw√§hlen</h2>

            <form method="get" action="{{ url_for('summary') }}">

                <div class="date-inputs">

                    <label for="start_date">Von:</label>

                    <input type="date" id="start_date" name="start_date" value="{{ start_date }}" required>

                    

                    <label for="end_date">Bis:</label>

                    <input type="date" id="end_date" name="end_date" value="{{ end_date }}" required>

                    

                    <button type="submit" class="btn">Aktualisieren</button>

                </div>

            </form>

        </div>

        

        <!-- Summary Results -->

        <div class="summary-section">

            <div class="summary-header">

                <div>

                    <div class="date-range-display">

                        {% if start_date == end_date %}

                            {{ start_date }}

                        {% else %}

                            {{ start_date }} bis {{ end_date }}

                        {% endif %}

                    </div>

                    <h2>Zeiterfassung nach Tickets</h2>

                </div>

                <div class="total-time">

                    Gesamt: {{ "%.2f"|format(total_time) }}h

                </div>

            </div>

            

            {% if summary_data %}

                <table class="summary-table">

                    <thead>

                        <tr>

                            <th>Ticket</th>

                            <th style="text-align: right;">Stunden</th>

                            <th style="text-align: right;">Anteil</th>

                        </tr>

                    </thead>

                    <tbody>

                        {% for ticket_name, hours in summary_data.items() %}

                        <tr>

                            <td class="ticket-name">{{ ticket_name }}</td>

                            <td class="hours">{{ "%.2f"|format(hours) }}h</td>

                            <td class="percentage">

                                {% if total_time > 0 %}

                                    {{ "%.1f"|format((hours / total_time) * 100) }}%

                                {% else %}

                                    0%

                                {% endif %}

                            </td>

                        </tr>

                        {% endfor %}

                    </tbody>

                </table>

            {% else %}

                <div class="no-data">

                    Keine Daten f√ºr den ausgew√§hlten Zeitraum gefunden.

                </div>

            {% endif %}

        </div>

    </div>

    

    <script>

        // Set default date range to today if both are the same

        document.addEventListener('DOMContentLoaded', function() {

            const startDate = document.getElementById('start_date');

            const endDate = document.getElementById('end_date');

            

            // Quick date range buttons could be added here in the future

        });

    </script>

</body>

</html>
